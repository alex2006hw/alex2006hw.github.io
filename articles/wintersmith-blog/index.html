<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scale=0">
    <meta name="description" content="A custom template for Wintersmith, a cool, simple and flexible static site generator. Supports tags and timeline. source on GitHub.">
    <title>AH: Wintersmith custom template - Snowboot - Andy Hulstkamp
    </title>
    <link rel="author" href="https://plus.google.com/u/0/103966119359439831864/about">
    <link rel="alternate" href="http://www.hulstkamp.com/feed.xml" type="application/rss+xml" title="about creating online experiences">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto+Slab:400,700|Open+Sans">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.2.0/pure-min.css">
    <link rel="stylesheet" href="/css/ah.min.css">
    <!--link(rel='stylesheet', href='/css/main.css')-->
    <!--link(rel='stylesheet', href='/css/monokai.css')-->
    <!--script(type="text/javascript", src='/scripts/highlight.pack.js').-->
    <!--script(type="text/javascript", src='/scripts/ah.js').-->
    <script type="text/javascript" src="/scripts/ah.min.js"></script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-5499195-1']);
      _gaq.push(['_trackPageview']);
      (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body class="article-detail">
    <div class="container">
      <header class="header">
        <div class="content-wrap">
          <div>
            <div>
              <div class="image">
                <div class="photo"></div>
              </div>
              <div class="signature">
                <h3 class="heading"><a href="http://www.hulstkamp.com">Andy Hulstkamp</a></h3>
                <p class="description">about creating online experiences</p>
              </div>
            </div>
          </div>
        </div>
      </header>
            <nav id="mainNavi" class="main-navi">
              <div id="naviToggle" class="navi-toggle"><img src="/svg/59_w.svg"></div>
              <ul id="naviList" class="nav-items none">
                <li class="nav-item"><a alt="HOME" href="/" class="button transparent">HOME</a></li>
                <li class="nav-item"><a alt="INDEX" href="/tagindex/" class="button transparent">INDEX</a></li>
                <li class="nav-item"><a alt="TIMELINE" href="/timeline/" class="button transparent">TIMELINE</a></li>
                <li class="nav-item"><a alt="ABOUT" href="/about/" class="button transparent">ABOUT</a></li>
                <li class="nav-item"><a alt="CONTACT" href="/contact/" class="button transparent">CONTACT</a></li>
              </ul>
            </nav>
      <div id="content" class="content">
        <div class="content-wrap">
          <article class="article intro pure-g-r">
            <header class="pure-u-1">
              <div class="date pure-u-1">10. October 2012
              </div>
              <h1 class="heading pure-u-1">Wintersmith custom template - Snowboot
              </h1>
              <div class="tags"><a href="/tags/tools.html" class="tag">tools</a><a href="/tags/wintersmith.html" class="tag"> wintersmith</a><a href="/tags/jade.html" class="tag"> jade</a>
              </div>
            </header>
            <section class="content pure-u-1"><p>I had this blog running on an outdated version of Wordpress and an update was on order.
Updating a customised <span class="caps">WP</span>-Version sucks and I don’t really need all the features WP offers so I decided to switch to a static site generator.
I had a look at a couple of options and settled for Wintersmith. It is straightforward to setup and easy to&nbsp;customise.</p>
<p>Here are some notes on how I customised this blog using&nbsp;Wintersmith. </p>
<p><span class="more"></span></p>
<div class="update">
    <strong><span class="caps">UPDATE</span></strong>
    I’ve created a new <a href="/articles/custom-wintersmith-template-milchglas/">custom Wintersmith template</a>, that is compatible with Version 2.0.*.
    Most of the notes provided here do still apply, though.
</div>

<h3 id="getting-started">Getting&nbsp;started</h3>
<p>Setting up Wintersmith is easy. <a href="https://github.com/jnordberg/wintersmith">Check the official guide</a> to get&nbsp;started.</p>
<p>Once Wintersmith is set up,&nbsp;invoke…</p>
<pre><code class="lang-dos">    <span class="keyword">cd</span> [working-directory]
    wintersmith preview
</code></pre>
<p>…in order to see the changes while editing blog entries or Customising&nbsp;templates.</p>
<h3 id="customising">Customising</h3>
<p>Customisation in Wintersmith revolves&nbsp;around</p>
<ul>
<li>Jade-templates</li>
<li>page&nbsp;meta-data</li>
<li>configuration&nbsp;files</li>
<li>the content&nbsp;tree</li>
</ul>
<h4 id="custom-templates-meta-data">Custom Templates <span class="amp">&amp;</span>&nbsp;Meta-Data</h4>
<p>Wintersmith uses <a href="http://jade-lang.com/">Jade</a> for&nbsp;templates.</p>
<p>Layout.jade is the main template of my blog. It is my basic template, where all blocks and default content are specified, more specific templates inherit from layout.jade to provide custom <span class="caps">LAF</span> on specific&nbsp;pages.</p>
<p>Each page in Wintersmith specifies which template to use for rendering. For instance, at the top of the index.md page of this blog entry, I’ve&nbsp;got: </p>
<pre>
  <code class="no-highlight">
    title: Wintersmith notes
    abstract: Some abstract...
    author: Andy Hulstkamp
    date: 2012-10-10 12:20
    template: article.jade
    tags: tools
    type: post
    status: published
  </code>
</pre>

<p>which tells Wintersmith to use article.jade to render this page. The template will also give access to all the other variables like title, tags etc. I specified&nbsp;here. </p>
<p>article.jade is&nbsp;simply:</p>
<pre>
  <code class="no-highlight">
extends layout
block content
  a.back(href='/') &larr; BACK TO INDEX
  br
  br
  h2
    = page.title
  article.single.post
    section.content
      != page.html
    br
    a.back(href='/') &larr; BACK TO INDEX
  </code>
</pre>

<p>It inherits from layout.jade where the header-, navigation- and footer structures are defined and specifies the content block to use for&nbsp;articles.</p>
<p>When a page is rendered, the template gets a reference to the <em>page</em> instance. The page is available as <em>page</em> in the template context. The content tree is also available as <em>contents</em> and the config.locals object as <em>locals</em>. underscore.js is available as <em>__ to provide some utility functions. Custom variables specified on the page may be accessed by _page.metadata</em>.</p>
<p>Page-Title and Page-Content are accessed in a template like&nbsp;this:</p>
<pre><code>h2
  = page.title
  article.single.post
    section.content
      != page.html
</code></pre><h4 id="navigation-configuration-files">Navigation <span class="amp">&amp;</span> Configuration&nbsp;Files</h4>
<p>An important file is <em>config.json</em>. This is where I put global stuff such as the data for my&nbsp;navigation</p>
<pre><code class="lang-Json">{
  &quot;locals&quot;: {
    &quot;url&quot;: &quot;http://localhost:8080&quot;,
    &quot;name&quot;: &quot;Andy Hulstkamp&quot;,
    &quot;title&quot;: &quot;Andy Hulstkamps blog&quot;,
    &quot;owner&quot;: &quot;Andy Hulstkamp&quot;,
    &quot;description&quot;: &quot;stuff&quot;,
    &quot;index_articles&quot;: 5,
    &quot;nav&quot; : [
      {
        &quot;name&quot;: &quot;Home&quot;,
        &quot;cssClass&quot;: &quot;home&quot;,
        &quot;description&quot;: &quot;Home Page&quot;,
        &quot;url&quot;: &quot;/&quot;
      },
      {
        &quot;name&quot;: &quot;Blog&quot;,
        &quot;cssClass&quot;: &quot;blog&quot;,
        &quot;description&quot;: &quot;Blog&quot;,
        &quot;url&quot;: &quot;/blog&quot;
      },
      {
        &quot;name&quot;: &quot;About&quot;,
        &quot;cssClass&quot;: &quot;about&quot;,
        &quot;description&quot;: &quot;About &quot;,
        &quot;url&quot;: &quot;/about&quot;
      }
    ]  
  }
}
</code></pre>
<p>I use the <em>nav</em> array specified in config.json to create the navigation by looping over the entries in a&nbsp;template:</p>
<pre>
  <code class="no-highlight">
ul.nav.link-list
  each item in locals.nav
    li
      span.pikto 
        =item.cssClass
      a(href=item.url)= item.name
  </code>
</pre>

<h4 id="content-tree">Content&nbsp;Tree</h4>
<p>The content tree is a graph of all json-, page- or fileobjects in the contents folders (and&nbsp;subfolders).</p>
<p>For&nbsp;instance</p>
<pre><code class="lang-javascript">contents.tags[<span class="string">'spring.json'</span>]
</code></pre>
<p>holds the reference to a file named <em>spring.json</em> within the <em>tags</em>-folder in the <em>contents</em>&nbsp;directory.</p>
<p>If <em>spring.json</em> is something&nbsp;like…</p>
<pre><code class="lang-json">{
  "<span class="attribute">id</span>": <span class="value"><span class="string">"spring"</span></span>,
  "<span class="attribute">name</span>": <span class="value"><span class="string">"Spring"</span></span>,
  "<span class="attribute">cssClass</span>": <span class="value"><span class="string">"spring"</span></span>,
  "<span class="attribute">description</span>": <span class="value"><span class="string">"Spring <span class="caps">JEE</span> Framework"</span>
</span>}
</code></pre>
<p>…I can access the cssClass property&nbsp;like</p>
<pre><code class="lang-javascript">contents.tags[<span class="string">'spring.json'</span>].cssClass
</code></pre>
<p>…which is how I did the tags for the site. 
Tags are not an implicit part of Wintersmith, but can easily be achieved by using page-metadata, the content tree and a&nbsp;mixin.</p>
<p>At the top of each page I added a list of strings to tag a&nbsp;page:</p>
<pre><code class="lang-json">    tags: flex, java, junit
</code></pre>
<p>In a template I can fetch this metadata through <em>page.metdata</em> and use underscore to turn it into an array.
I can then loop over the array and build a&nbsp;list.</p>
<pre>
  <code class="no-highlight">
  - var tagsarray = _.toArray(page.metadata.tags.split(','))
        ul
          each tag in tagsarray
              li= tag
  </code>
</pre>

<p>Within the loop I can fetch additional data per tag and use this data to render the final list.
I used a mixin oto get this done in a generic&nbsp;way.</p>
<h4 id="mixin-and-data-references">Mixin and data&nbsp;references</h4>
<p>I can reference other variables using the tag as a key to load data from the content tree.
This following block loops over an array of tags and uses a mixin to access data in the content&nbsp;tree…</p>
<pre>
  <code class="no-highlight">
 div.tagindex
    h1 TAGINDEX
    ul.tagindex
      - for (var k in tags)
        li.tag 
          mixin tag(k)
          ul
            - var groupedValues = _.values(tags[k])
            - for (var ki in groupedValues)
              li.tagged.row
                h4.title
                 a(href=groupedValues[ki].obj.url)= groupedValues[ki].title
                p.abstract.seven.column= groupedValues[ki].abstract
  </code>
</pre>

<p>The mixin is simply a block of html structure that can be&nbsp;parameterised </p>
<pre>
  <code class="no-highlight">
mixin tag(tagName)
  - var tag = contents.tags[tagName + '.json']
    if tag
      span.pikto J
        a(href=tagName)
          = tag.metadata.name
    else
      = tagName
  </code>
</pre>

<p>The mixin here is simply defined in a separate jade-template file; this one is in a file called tag.jade under the templates&nbsp;folder. </p>
<p>A .json file in the content tree is dynamically accessed using the tagName. 
For instance, within my contents/tags folder I have a file named ux.json that holds some data in context to the ux&nbsp;tagName</p>
<pre><code class="lang-JSON">{
  &quot;id&quot;: &quot;ux&quot;,
  &quot;name&quot;: &quot;UX, Usability, Interface Design&quot;,
  &quot;cssClass&quot;: &quot;ux&quot;,
  &quot;description&quot;: &quot;all user-centric things&quot;
}
</code></pre>
<p>The mixin looks up the data in this file when tagName is <em>ux</em> and renders the tag-related structure&nbsp;accordingly.</p>
<h3 id="good-to-know">Good to&nbsp;know</h3>
<h4 id="directories-filenames-html-content">Directories, Filenames,&nbsp;Html-Content</h4>
<p>Again, the content tree is just the tree of json-, page- and fileobjects under the contents&nbsp;folder.</p>
<pre>
  <code class="no-highlight">
 - var directories = ___.map(contents.articles._.directories, function(item) {
  -                                    return item
  - })
  </code>
</pre>

<p>will get all&nbsp;directories. </p>
<p>Loop over&nbsp;directories:</p>
<pre>
  <code class="no-highlight">
  ul
  each dir in directories
    li
      strong dir.filename (dir): 
      span #{dir.filename}
      br
      strong  dir.index.filename: 
      span #{dir.index.filename}
      br
      strong dir.index.metadata.tags
      span #{dir.index.metadata.tags}
  </code>
</pre>

<p>include html from a page in a&nbsp;template:</p>
<pre>
  <code class="no-highlight">
!= page.html
  </code>
</pre>

<h4 id="extending-blocks-in-templates">Extending blocks in&nbsp;templates</h4>
<p>Any block defined in a template can be overwritten and elements can be appended or prepended. For the detail page I need specific javascript and styles that can be linked in the header by appending to the head block of the parent&nbsp;template.</p>
<pre>
  <code class="no-highlight">
block append head
  link(rel='stylesheet', href="stylesheets/ahimpr.css")
  script(type='text/javascript', src='js/ah.js')
  script(type='text/javascript', src='js/modernizr.js')
  script(type="text/javascript")
    $(document).ready(function () {
      AHUI.setupDiashow($(".photobox"),$(".keyControlHolder"));
    });
  </code>
</pre>

<h4 id="use-mixins-for-repeated-customised-content">Use Mixins for repeated customised&nbsp;content</h4>
<p>I have a couple of older Flash-stuff I wanted to move over to the static site. Here’s a way to deal with the swf-objects includes that are required for flash&nbsp;content. </p>
<p>Mixin defined in parent&nbsp;template: </p>
<pre>
  <code class="no-highlight">
extends layout
mixin useFlash(file)
  style
    html, body  { height:100%; }
    body { 
      margin:0; padding:0; overflow:auto; text-align:left; 
      background-color: #fafafa; 
    }
    #flashContent { display:none; 
    }
  script(type="text/javascript", src="swfobject.js")
  script(type="text/javascript", src="history/history.js")
  link(rel="stylesheet", type="text/css", href="history/history.css")
  script
    var swfVersionStr = "10.0.0";
    <!-- To use express install, set to playerProductInstall.swf, otherwise the empty string. -->
    var xiSwfUrlStr = "playerProductInstall.swf";
    var flashvars = {};
    var params = {};
    params.quality = "high";
    params.bgcolor = "#fafafa";
    params.allowscriptaccess = "sameDomain";
    params.allowfullscreen = "true";
    var attributes = {};
    attributes.id = "#{file}";
    attributes.name = "#{file}";
    attributes.align = "middle";
    swfobject.embedSWF("#{file}.swf", "flashContent", "100%", "100%", swfVersionStr, xiSwfUrlStr, flashvars, params, attributes);
    <!-- JavaScript enabled so display the flashContent div in case it is not replaced with a swf object. -->
    swfobject.createCSS("#flashContent", "display:block;text-align:left;");
block append head
 mixin useFlash(page.metadata.swf)
block content
  article.post
    section.content!= page.html
    a.back(href='./') &larr; <span class="caps">BACK</span> TO POST
  </code>
</pre>

<p>we can pass objects defined on the page to the mixin, therefore generalising repeated parameterised&nbsp;content. </p>
<h3 id="troubleshooting">Troubleshooting</h3>
<h4 id="migration">Migration</h4>
<p>While moving html pages from my old blog to Wintersmith, simply coping and pasting the html structures into Wintersmith could cause trouble. Sometimes jade would just ignore script or link tags. This could usually be corrected by reintending the tags&nbsp;properly. </p>
<h4 id="speeding-up-builds">Speeding up&nbsp;builds</h4>
<p>Wintersmith builds a content tree based on the files located in the contents folder (and subfolders). While developing templates or writing new articles it might be useful to temporarily move old articles out of the contents folders and back in when you choose to make the final&nbsp;build. </p>
<h4 id="updates">Updates</h4>
<p>Updates on config.json are not visible in the Wintersmith preview. A restart of the Wintersmith preview is&nbsp;necessary. </p>
<h3 id="tooling">Tooling</h3>
<p>I use Sublime Text 2 for blog entries. To setup a build process&nbsp;put </p>
<pre><code class="lang-JSON">{
    &quot;cmd&quot;: [&quot;wintersmith.cmd&quot;, &quot;build&quot;, &quot;-v&quot;],
    &quot;path&quot;: &quot;c:/path/to/wintersmith/blog/root&quot;,
    &quot;working_dir&quot;: &quot;{project_path}&quot;  
}
</code></pre>
<p>under Tools/Build System/New Build&nbsp;System.</p>
<p>This will make wintersmith build available as build process in&nbsp;st.</p>
<h4 id="firefox-auto-reload-add-on">Firefox auto reload add&nbsp;on</h4>
<p>Tools/AutoReload&nbsp;Preferences/ </p>
<ul>
<li>create <a href="http://localhost:8080/">http://localhost:8080/</a></li>
<li>add when local file&nbsp;changes </li>
<li>add directory where the blog structure&nbsp;lies</li>
</ul>
<h3 id="jade-wintersmith-key-points">Jade <span class="amp">&amp;</span> Wintersmith key&nbsp;points</h3>
<ul>
<li>Templating engine inspired by <span class="caps">HAML</span>  (Javscript,&nbsp;Node)</li>
<li>Define default template in&nbsp;layout.jade</li>
<li>layout.jade defines the default structure using default blocks for header, head, content etc <a href="https://github.com/visionmedia/jade#template-inheritance">see jade&nbsp;blocks</a></li>
<li>custom layouts created by extending layout.jade and prepending, appending or replacing the block elements in layout.jade<ul>
<li><em>block header</em> to replace the header&nbsp;block</li>
<li><em>block append header</em> to append to the header&nbsp;block</li>
<li><em>block prepend header</em> to prepend to the header&nbsp;block</li>
</ul>
</li>
<li>Each content page refers to a layout, set at the top of each content page (template:&nbsp;article.jade)</li>
<li>Have a look at article.jade, it extends layout.jade and replaces the title, header and content&nbsp;blocks.</li>
<li>supports vanilla javascript. In Wintersmith underscore _ is provided as&nbsp;well.</li>
</ul>
<div class="button-holder one">
    <a href="https://github.com/ndhu/snowboot-wintersmith-templates" class="button github">GitHub</a>
</div>
</section>
            <!--TODO: refactor this out for better separation of concerns-->
            <section class="further-readings pure-g-r">
              <h3>further reading</h3>
              <div class="further-reading-article pure-u-1-2"><a href="/articles/custom-wintersmith-template-milchglas/">
                  <h4 class="clipped">Milchglas - a custom Wintersmith template
                  </h4></a>
                <p><a href="/articles/custom-wintersmith-template-milchglas/">A custom Wintersmith template that is compatible with Version 2.0.* of Wintersmith.</a></p>
              </div>
              <div class="further-reading-article pure-u-1-2"><a href="/articles/custom-wintersmith-template-milchglas/">
                  <h4 class="clipped">Milchglas - a custom Wintersmith template
                  </h4></a>
                <p><a href="/articles/custom-wintersmith-template-milchglas/">A custom Wintersmith template that is compatible with Version 2.0.* of Wintersmith.</a></p>
              </div>
            </section>
            <!--TODO: refactor this out for better separation of concerns-->
          </article>
        </div>
      </div>
      <nav class="paging pure-g-r"><a href="/articles/custom-wintersmith-template-milchglas/" class="pure-u-1-2">
          <div class="ah-icon-link newer left"><span class="text text-right">Prev</span><img src="/svg/53_b.svg" class="ah-icon ah-icon-left"/></div></a><a href="/" class="pure-u-1-2">
          <div class="ah-icon-link older right"><span class="text text-left">Next</span><img src="/svg/54_b.svg" class="ah-icon ah-icon-right"/></div></a>
      </nav>
      <footer>
        <div class="content-wrap">
                    <div class="footer-links pure-g-r">
                      <div class="footer-link pure-u-1-8"><a alt="home" href="/" class="ah-icon-link">
                          <h4>&nbsp;</h4><img src="/svg/115_b.svg">
                          <h4>HOME</h4></a></div>
                      <div class="footer-link pure-u-1-8"><a alt="archive" href="/timeline/" class="ah-icon-link">
                          <h4>&nbsp;</h4><img src="/svg/109_b.svg">
                          <h4>TIMELINE</h4></a></div>
                      <div class="footer-link pure-u-1-8"><a alt="about" href="/about/" class="ah-icon-link">
                          <h4>&nbsp;</h4><img src="/svg/89_b.svg">
                          <h4>ABOUT</h4></a></div>
                      <div class="footer-link pure-u-1-8"><a alt="contact" href="/contact/" class="ah-icon-link">
                          <h4>&nbsp;</h4><img src="/svg/99_b.svg">
                          <h4>CONTACT</h4></a></div>
                      <div class="footer-link pure-u-1-8"><a href="https://plus.google.com/103966119359439831864" class="ah-icon-link">
                          <h4>&nbsp;</h4><img src="/svg/google-plus.svg">
                          <h4>Google+</h4></a></div>
                      <div class="footer-link pure-u-1-8"><a href="http://www.twitter.com/andyhulstkamp" class="ah-icon-link">
                          <h4>&nbsp;</h4><img src="/svg/twitter.svg">
                          <h4>Twitter</h4></a></div>
                      <div class="footer-link pure-u-1-8"><a href="http://www.cityclash.org" class="ah-icon-link">
                          <h4>&nbsp;</h4><img src="/img/cityclash-48-48.png">
                          <h4>Owner/Creator</h4></a></div>
                      <div class="footer-link pure-u-1-8"><a href="http://www.cocomoshi.ch" class="ah-icon-link">
                          <h4>&nbsp;</h4><img src="/img/cocomoshi-48-48.png">
                          <h4>Owner/Creator</h4></a></div>
                    </div>
          <!--
          section.about
          !=contents['about.md'].html
          -->
          <section class="pure-g-r">
            <div class="copy pure-u-1"><span>&copy; 2014</span><span> content, design &amp; template</span><a href="https://github.com/ndhu/wintersmith-milchglas-template">&nbsp;Milchglas&nbsp;</a><span>by Andreas Hulstkamp &mdash; powered by&nbsp;</span><a href="https://github.com/jnordberg/wintersmith">Wintersmith&nbsp;</a></div>
          </section>
        </div>
      </footer>
    </div>
  </body>
</html>